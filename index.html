<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servicio de Impresiones Lumen</title>
    <!-- Enlace al archivo CSS -->
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <header>
        <h1>Servicio de Impresiones üöÄ</h1>
        <nav>
            <!-- Los botones de navegaci√≥n ahora llaman a la funci√≥n progresiva -->
            <button onclick="navigate('home')">Inicio</button>
            <button onclick="navigate('product-config')">Imprimir Ahora</button>
            <button onclick="navigate('cart')">üõí Carrito (<span id="cart-count">0</span>)</button>
        </nav>
    </header>

    <main id="app-container">
        
        <!-- SECCI√ìN 1: HOME (Inicio del flujo) -->
        <section id="home-view" class="view active">
            
            <!-- T√≠tulo Personalizado con Colores -->
            <h2 id="lumen-title">Servicio de Impresiones <span class="colorful-lumen">Lumen</span></h2>
            
            <!-- Banner 1200x360 -->
            <div id="main-banner">
                <!-- Imagen Placeholder de Banner -->
                <img src="assets/images/banner_placeholder.png" onerror="this.src='https://placehold.co/1200x360/007bff/ffffff?text=BANNER+1200x360'" alt="Banner Promocional de Impresiones">
            </div>

            <!-- Capas de Productos/Categor√≠as (4 por rengl√≥n en desktop) -->
            <h3 class="section-title">Nuestros Productos Principales</h3>
            <div id="product-grid">
                <!-- Item de Producto 1: Con bot√≥n expl√≠cito de navegaci√≥n -->
                <div class="product-item" onclick="navigate('product-config')">
                    <img src="assets/images/prod_doc.png" onerror="this.src='https://placehold.co/250x250/212529/ffffff?text=DOCUMENTS'" alt="Documentos B/N">
                    <h4>Impresi√≥n de Documentos</h4>
                    <p>R√°pida impresi√≥n de documentos en blanco y negro o a color sobre papel bond.</p>
                    <button class="small-btn">Configurar Pedido ‚Üí</button>
                </div>
                
                <!-- Item de Producto 2: Con bot√≥n expl√≠cito de navegaci√≥n -->
                <div class="product-item" onclick="navigate('product-config')">
                    <img src="assets/images/prod_color.png" onerror="this.src='https://placehold.co/250x250/dc3545/ffffff?text=COLOR'" alt="Impresi√≥n a Color">
                    <h4>Impresi√≥n a Color Profesional</h4>
                    <p>Ideal para presentaciones y folletos con colores vibrantes en papel couch√©.</p>
                    <button class="small-btn">Configurar Pedido ‚Üí</button>
                </div>
                
                <!-- Item de Producto 3: Con bot√≥n expl√≠cito de navegaci√≥n -->
                <div class="product-item" onclick="navigate('product-config')">
                    <img src="assets/images/prod_tarjetas.png" onerror="this.src='https://placehold.co/250x250/ffc107/343a40?text=CARDS'" alt="Tarjetas y Etiquetas">
                    <h4>Tarjetas y Etiquetas</h4>
                    <p>Impresi√≥n en papel grueso como opalina para tarjetas de presentaci√≥n y m√°s.</p>
                    <button class="small-btn">Configurar Pedido ‚Üí</button>
                </div>
                
                <!-- Item de Producto 4: Con bot√≥n expl√≠cito de navegaci√≥n -->
                <div class="product-item" onclick="navigate('product-config')">
                    <img src="assets/images/prod_planos.png" onerror="this.src='https://placehold.co/250x250/17a2b8/ffffff?text=PLANS'" alt="Ploteo y Planos">
                    <h4>Ploteo y Planos</h4>
                    <p>Servicio de impresi√≥n de gran formato para arquitectura e ingenier√≠a.</p>
                    <button class="small-btn">Configurar Pedido ‚Üí</button>
                </div>
            </div>
            
            <!-- Carrusel de Productos Destacados -->
            <h3 class="section-title">Ofertas Destacadas</h3>
            <div id="carousel-container">
                <button class="carousel-btn prev-btn">‚Üê</button>
                <div id="product-carousel">
                    <!-- √çtems del Carrusel: Ahora con onclick para navegar -->
                    <div class="carousel-item" onclick="navigate('product-config')">
                        <img src="assets/images/carousel_item1.png" onerror="this.src='https://placehold.co/800x300/e9ecef/343a40?text=OFERTA+1'" alt="Oferta 1">
                        <div class="caption">50% de descuento en impresiones B/N. ¬°Click para pedir!</div>
                    </div>
                    <div class="carousel-item" onclick="navigate('product-config')">
                        <img src="assets/images/carousel_item2.png" onerror="this.src='https://placehold.co/800x300/ced4da/343a40?text=OFERTA+2'" alt="Oferta 2">
                        <div class="caption">Env√≠o gratis en pedidos mayores a $500. ¬°Click para pedir!</div>
                    </div>
                    <div class="carousel-item" onclick="navigate('product-config')">
                        <img src="assets/images/carousel_item3.png" onerror="this.src='https://placehold.co/800x300/adb5bd/343a40?text=OFERTA+3'" alt="Oferta 3">
                        <div class="caption">Papel reciclado premium al precio del bond. ¬°Click para pedir!</div>
                    </div>
                </div>
                <button class="carousel-btn next-btn">‚Üí</button>
            </div>

            <!-- Informaci√≥n SEO -->
            <h3 class="section-title">Expertos en Impresi√≥n Digital</h3>
            <div id="seo-info">
                <p>En Servicio de Impresiones Lumen, ofrecemos la m√°s alta calidad en impresi√≥n digital y ploteo, con servicio r√°pido para documentos, flyers y material promocional. Nuestro sistema online te permite cotizar al instante y subir tus archivos directamente a Google Drive, asegurando una gesti√≥n eficiente y segura de tu pedido. ¬°R√°pido, f√°cil y profesional!</p>
                <p>Trabajamos con diversos tipos de papel, desde bond est√°ndar hasta couch√© brillante y opalina, en tama√±os carta, oficio y tabloide, con opciones d√∫plex (dos caras). Conf√≠a en nuestra experiencia para tus proyectos personales y empresariales. Consulta nuestras sucursales en [Sucursal 54], [Sucursal Relox], y [Sucursal Puebla] para recoger tu pedido o elige env√≠o a domicilio.</p>
            </div>
            
            <button class="primary-btn" onclick="navigate('product-config')">Empezar a Configurar mi Impresi√≥n</button>
        </section>

        <!-- SECCIONES 2 a 5: SIN CAMBIOS -->
        <section id="product-config-view" class="view hidden">
            <h2>1. Carga tu Archivo y Configura</h2>
            
            <h3>Sube tu Documento (.pdf, .doc, .docx)</h3>
            <div class="file-upload-area">
                <input type="file" id="document-file" accept=".pdf,.doc,.docx" required>
                <div id="upload-status">Haz clic para seleccionar tu archivo</div>
            </div>

            <h3>Configura las Opciones de Impresi√≥n</h3>
            <form id="product-form">
                <input type="hidden" id="file-id" value=""> 
                <input type="hidden" id="file-name" value=""> 

                <label for="color">Color:</label>
                <select id="color" required>
                    <option value="b/n">Blanco y Negro</option>
                    <option value="color">Color</option>
                </select>

                <label for="paper">Tipo de Papel:</label>
                <select id="paper" required>
                    <option value="bond">Bond</option>
                    <option value="opalina">Opalina</option>
                    <option value="couche">Couche</option>
                </select>

                <label for="size">Tama√±o:</label>
                <select id="size" required>
                    <option value="carta">Carta</option>
                    <option value="oficio">Oficio</option>
                    <option value="tabloide">Tabloide</option>
                </select>

                <label for="sides">Impresi√≥n:</label>
                <select id="sides" required>
                    <option value="una cara">Una Cara</option>
                    <option value="dos caras">Dos Caras (D√∫plex)</option>
                </select>
                
                <label for="page-count">P√°ginas Estimadas:</label>
                <input type="number" id="page-count" value="1" min="1" readonly>

                <label for="cantidad">Copias (Cantidad):</label>
                <input type="number" id="cantidad" value="1" min="1" required>

                <label for="comentarios">Comentarios Adicionales:</label>
                <textarea id="comentarios" rows="2" placeholder="Ej: No imprimir la primera p√°gina."></textarea>
                
                <p class="price-estimate">Precio por P√°gina: $<span id="page-price">0.00</span></p>
                <p class="price-estimate">SUBTOTAL DEL ART√çCULO: $<span id="item-subtotal">0.00</span></p>

                <button type="button" class="primary-btn" onclick="addItemToCart()">‚ûï Agregar al Carrito</button>
            </form>
        </section>

        <!-- SECCI√ìN 3: CARRITO DE COMPRAS -->
        <section id="cart-view" class="view hidden">
            <h2>2. üõí Revisa tu Carrito</h2>
            <div id="cart-items-list">
                <p class="empty-cart">Tu carrito est√° vac√≠o.</p>
            </div>
            
            <div id="cart-summary">
                <h3>Total del Pedido</h3>
                <p>Total a Pagar: $<span id="cart-total">0.00</span></p>
            </div>

            <div class="checkout-actions">
                <input type="checkbox" id="privacy-check">
                <label for="privacy-check">Acepto los <a href="#" target="_blank">Avisos de Privacidad</a> y <a href="#" target="_blank">T√©rminos y Condiciones</a>.</label>
                
                <button class="primary-btn" id="pre-checkout-btn" disabled>Continuar y Elegir Entrega</button>
            </div>
        </section>

        <!-- SECCI√ìN 3.5: DATOS DEL CLIENTE Y ENTREGA (NUEVA VISTA) -->
        <section id="client-info-view" class="view hidden">
            <h2>3. Datos de Contacto y Entrega</h2>
            <form id="client-form">
                <h3>Informaci√≥n de Contacto</h3>
                <label for="client-name">Nombre Completo:</label>
                <input type="text" id="client-name" required>

                <label for="client-email">Email (Para Confirmaci√≥n):</label>
                <input type="email" id="client-email" required>

                <label for="client-phone">Tel√©fono (WhatsApp/Llamada):</label>
                <input type="tel" id="client-phone" required>

                <h3>M√©todo de Entrega</h3>
                <label for="delivery-method">M√©todo:</label>
                <select id="delivery-method" required onchange="toggleDeliveryOptions(this.value)">
                    <option value="tienda">Recoger en Sucursal</option>
                    <option value="domicilio">Env√≠o a Domicilio</option>
                </select>

                <!-- Opciones Condicionales -->
                <div id="sucursal-options">
                    <label for="client-sucursal">Selecciona Sucursal:</label>
                    <select id="client-sucursal" required>
                        <!-- Las opciones deben coincidir con tu Apps Script (carpetasSucursales) -->
                        <option value="Sucursal 54">Sucursal 54</option>
                        <option value="Sucursal Relox">Sucursal Relox</option>
                        <option value="Sucursal Puebla">Sucursal Puebla</option>
                    </select>
                </div>

                <div id="domicilio-options" class="hidden">
                    <label for="client-address">Direcci√≥n de Env√≠o Completa:</label>
                    <textarea id="client-address" rows="3" placeholder="Calle, N√∫mero, Colonia, C.P., Ciudad"></textarea>
                    <!-- NOTA: Aqu√≠ se puede a√±adir la l√≥gica de COSTO DE ENV√çO -->
                    <p class="price-estimate">Costo de Env√≠o: $0.00 (Se cotizar√° al final)</p>
                </div>
                
                <div id="final-total-summary" style="margin-top: 20px; text-align: right;">
                    <strong>Total a Pagar: $<span id="final-total-checkout">0.00</span></strong>
                </div>

                <button type="submit" class="primary-btn" id="proceed-to-payment-btn">Finalizar y Pagar con Conekta</button>
                <button type="button" class="secondary-btn" onclick="navigate('cart')">‚Üê Volver al Carrito</button>
            </form>
        </section>


        <!-- SECCI√ìN 4: PAGO CONEKTA -->
        <section id="payment-view" class="view hidden">
            <h2>4. Redireccionando a Pago Seguro (Conekta)</h2>
            <p>Ser√°s redirigido a la plataforma de pago de Conekta para completar tu transacci√≥n por $<span id="payment-total">0.00</span>.</p>
            <p>Si la redirecci√≥n no ocurre en unos segundos, <a href="#" id="conekta-link" target="_blank">haz clic aqu√≠ para pagar.</a></p>
            
            <p style="margin-top: 20px;">*Este paso se salta en la demostraci√≥n para simular un pago exitoso.*</p>
        </section>
        
        <!-- SECCI√ìN 5: CONFIRMACI√ìN DE PEDIDO (Final del flujo) -->
        <section id="confirmation-view" class="view hidden">
            <h2>5. üéâ ¬°Pedido Enviado! Gracias por tu Compra.</h2>
            <p>Tu pedido ha sido registrado con √©xito. Te hemos enviado un correo electr√≥nico de confirmaci√≥n a los datos proporcionados.</p>
            <p>Guarda el siguiente folio para cualquier consulta:</p>
            <h3 id="order-folio">LMN-XXXXX</h3>
            
            <p style="margin-top: 25px;">Puedes volver al <a href="#" onclick="navigate('home')">Inicio</a> para hacer otro pedido.</p>
        </section>

    </main>

    <!-- Enlace al archivo JavaScript -->
    <script src="script.js"></script>
</body>
</html>